window.kmlUtils=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){(function(n){var o;if("undefined"!=typeof XMLSerializer)o=new XMLSerializer;else{var i="object"==typeof n&&!n.browser,a="object"==typeof Titanium;if("object"!=typeof t||!i&&!a)throw new Error("Unable to initialize serializer");o=new(r(7).XMLSerializer)}function s(e,t){return e.getElementsByTagName(t)}function u(e,t){return e.getAttribute(t)}function c(e){return e.normalize?e.normalize():e}e.exports={parent:function(e){return e.parentElement||e.parentNode||null},get:s,get1:function(e,t){const r=s(e,t);return r.length?r[0]:null},attr:u,setAttr:function(e,t,r){return e.setAttribute(t,r)},attrf:function(e,t){return parseFloat(u(e,t))},norm:c,nodeVal:function(e){return e&&c(e),e&&e.textContent||""},xml2str:function(e){return void 0!==e.xml?e.xml:o.serializeToString(e)}}}).call(this,r(6))},function(e,t){function r(e,t){for(var r in e)t[r]=e[r]}function n(e,t){var n=e.prototype;if(Object.create){var o=Object.create(t.prototype);n.__proto__=o}if(!(n instanceof t)){function i(){}i.prototype=t.prototype,r(n,i=new i),e.prototype=n=i}n.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),n.constructor=e)}var o="http://www.w3.org/1999/xhtml",i={},a=i.ELEMENT_NODE=1,s=i.ATTRIBUTE_NODE=2,u=i.TEXT_NODE=3,c=i.CDATA_SECTION_NODE=4,l=i.ENTITY_REFERENCE_NODE=5,f=i.ENTITY_NODE=6,p=i.PROCESSING_INSTRUCTION_NODE=7,h=i.COMMENT_NODE=8,d=i.DOCUMENT_NODE=9,m=i.DOCUMENT_TYPE_NODE=10,g=i.DOCUMENT_FRAGMENT_NODE=11,y=i.NOTATION_NODE=12,v={},w={},b=(v.INDEX_SIZE_ERR=(w[1]="Index size error",1),v.DOMSTRING_SIZE_ERR=(w[2]="DOMString size error",2),v.HIERARCHY_REQUEST_ERR=(w[3]="Hierarchy request error",3)),N=(v.WRONG_DOCUMENT_ERR=(w[4]="Wrong document",4),v.INVALID_CHARACTER_ERR=(w[5]="Invalid character",5),v.NO_DATA_ALLOWED_ERR=(w[6]="No data allowed",6),v.NO_MODIFICATION_ALLOWED_ERR=(w[7]="No modification allowed",7),v.NOT_FOUND_ERR=(w[8]="Not found",8)),S=(v.NOT_SUPPORTED_ERR=(w[9]="Not supported",9),v.INUSE_ATTRIBUTE_ERR=(w[10]="Attribute in use",10));v.INVALID_STATE_ERR=(w[11]="Invalid state",11),v.SYNTAX_ERR=(w[12]="Syntax error",12),v.INVALID_MODIFICATION_ERR=(w[13]="Invalid modification",13),v.NAMESPACE_ERR=(w[14]="Invalid namespace",14),v.INVALID_ACCESS_ERR=(w[15]="Invalid access",15);function x(e,t){if(t instanceof Error)var r=t;else r=this,Error.call(this,w[e]),this.message=w[e],Error.captureStackTrace&&Error.captureStackTrace(this,x);return r.code=e,t&&(this.message=this.message+": "+t),r}function T(){}function E(e,t){this._node=e,this._refresh=t,C(this)}function C(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);re(e,"length",n.length),r(n,e),e._inc=t}}function D(){}function P(e,t){for(var r=e.length;r--;)if(e[r]===t)return r}function M(e,t,r,n){if(n?t[P(t,n)]=r:t[t.length++]=r,e){r.ownerElement=e;var o=e.ownerDocument;o&&(n&&L(o,e,n),function(e,t,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&(t._nsMap[r.prefix?r.localName:""]=r.value)}(o,e,r))}}function k(e,t,r){var n=P(t,r);if(!(n>=0))throw x(N,new Error(e.tagName+"@"+r));for(var o=t.length-1;n<o;)t[n]=t[++n];if(t.length=o,e){var i=e.ownerDocument;i&&(L(i,e,r),r.ownerElement=null)}}function A(e){if(this._features={},e)for(var t in e)this._features=e[t]}function I(){}function _(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function O(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(O(e,t))return!0}while(e=e.nextSibling)}function R(){}function L(e,t,r,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&delete t._nsMap[r.prefix?r.localName:""]}function F(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r)n[n.length++]=r;else{for(var o=t.firstChild,i=0;o;)n[i++]=o,o=o.nextSibling;n.length=i}}}function j(e,t){var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,F(e.ownerDocument,e),t}function U(e,t,r){var n=t.parentNode;if(n&&n.removeChild(t),t.nodeType===g){var o=t.firstChild;if(null==o)return t;var i=t.lastChild}else o=i=t;var a=r?r.previousSibling:e.lastChild;o.previousSibling=a,i.nextSibling=r,a?a.nextSibling=o:e.firstChild=o,null==r?e.lastChild=i:r.previousSibling=i;do{o.parentNode=e}while(o!==i&&(o=o.nextSibling));return F(e.ownerDocument||e,e),t.nodeType==g&&(t.firstChild=t.lastChild=null),t}function G(){this._nsMap={}}function V(){}function z(){}function B(){}function $(){}function H(){}function q(){}function X(){}function J(){}function Y(){}function K(){}function W(){}function Q(){}function Z(e,t){var r=[],n=9==this.nodeType?this.documentElement:this,o=n.prefix,i=n.namespaceURI;if(i&&null==o&&null==(o=n.lookupPrefix(i)))var a=[{namespace:i,prefix:null}];return te(this,r,e,t,a),r.join("")}function ee(e,t,r){var n=e.prefix||"",o=e.namespaceURI;if(!n&&!o)return!1;if("xml"===n&&"http://www.w3.org/XML/1998/namespace"===o||"http://www.w3.org/2000/xmlns/"==o)return!1;for(var i=r.length;i--;){var a=r[i];if(a.prefix==n)return a.namespace!=o}return!0}function te(e,t,r,n,i){if(n){if(!(e=n(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case a:i||(i=[]);i.length;var f=e.attributes,y=f.length,v=e.firstChild,w=e.tagName;r=o===e.namespaceURI||r,t.push("<",w);for(var b=0;b<y;b++){"xmlns"==(N=f.item(b)).prefix?i.push({prefix:N.localName,namespace:N.value}):"xmlns"==N.nodeName&&i.push({prefix:"",namespace:N.value})}for(b=0;b<y;b++){var N;if(ee(N=f.item(b),0,i)){var S=N.prefix||"",x=N.namespaceURI,T=S?" xmlns:"+S:" xmlns";t.push(T,'="',x,'"'),i.push({prefix:S,namespace:x})}te(N,t,r,n,i)}if(ee(e,0,i)){S=e.prefix||"",x=e.namespaceURI,T=S?" xmlns:"+S:" xmlns";t.push(T,'="',x,'"'),i.push({prefix:S,namespace:x})}if(v||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(w)){if(t.push(">"),r&&/^script$/i.test(w))for(;v;)v.data?t.push(v.data):te(v,t,r,n,i),v=v.nextSibling;else for(;v;)te(v,t,r,n,i),v=v.nextSibling;t.push("</",w,">")}else t.push("/>");return;case d:case g:for(v=e.firstChild;v;)te(v,t,r,n,i),v=v.nextSibling;return;case s:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,_),'"');case u:return t.push(e.data.replace(/[<&]/g,_));case c:return t.push("<![CDATA[",e.data,"]]>");case h:return t.push("\x3c!--",e.data,"--\x3e");case m:var E=e.publicId,C=e.systemId;if(t.push("<!DOCTYPE ",e.name),E)t.push(' PUBLIC "',E),C&&"."!=C&&t.push('" "',C),t.push('">');else if(C&&"."!=C)t.push(' SYSTEM "',C,'">');else{var D=e.internalSubset;D&&t.push(" [",D,"]"),t.push(">")}return;case p:return t.push("<?",e.target," ",e.data,"?>");case l:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function re(e,t,r){e[t]=r}x.prototype=Error.prototype,r(v,x),T.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var r=[],n=0;n<this.length;n++)te(this[n],r,e,t);return r.join("")}},E.prototype.item=function(e){return C(this),this[e]},n(E,T),D.prototype={length:0,item:T.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var r=this[t];if(r.nodeName==e)return r}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new x(S);var r=this.getNamedItem(e.nodeName);return M(this._ownerElement,this,e,r),r},setNamedItemNS:function(e){var t,r=e.ownerElement;if(r&&r!=this._ownerElement)throw new x(S);return t=this.getNamedItemNS(e.namespaceURI,e.localName),M(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return k(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);return k(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){for(var r=this.length;r--;){var n=this[r];if(n.localName==t&&n.namespaceURI==e)return n}return null}},A.prototype={hasFeature:function(e,t){var r=this._features[e.toLowerCase()];return!(!r||t&&!(t in r))},createDocument:function(e,t,r){var n=new R;if(n.implementation=this,n.childNodes=new T,n.doctype=r,r&&n.appendChild(r),t){var o=n.createElementNS(e,t);n.appendChild(o)}return n},createDocumentType:function(e,t,r){var n=new q;return n.name=e,n.nodeName=e,n.publicId=t,n.systemId=r,n}},I.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return U(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return j(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,r,n){var o=new r.constructor;for(var i in r){var u=r[i];"object"!=typeof u&&u!=o[i]&&(o[i]=u)}r.childNodes&&(o.childNodes=new T);o.ownerDocument=t;switch(o.nodeType){case a:var c=r.attributes,l=o.attributes=new D,f=c.length;l._ownerElement=o;for(var p=0;p<f;p++)o.setAttributeNode(e(t,c.item(p),!0));break;case s:n=!0}if(n)for(var h=r.firstChild;h;)o.appendChild(e(t,h,n)),h=h.nextSibling;return o}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==u&&e.nodeType==u?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var n in r)if(r[n]==e)return n;t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&e in r)return r[e];t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},r(i,I),r(i,I.prototype),R.prototype={nodeName:"#document",nodeType:d,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==g){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return null==this.documentElement&&e.nodeType==a&&(this.documentElement=e),U(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),j(this,e)},importNode:function(e,t){return function e(t,r,n){var o;switch(r.nodeType){case a:(o=r.cloneNode(!1)).ownerDocument=t;case g:break;case s:n=!0}o||(o=r.cloneNode(!1));o.ownerDocument=t;o.parentNode=null;if(n)for(var i=r.firstChild;i;)o.appendChild(e(t,i,n)),i=i.nextSibling;return o}(this,e,t)},getElementById:function(e){var t=null;return O(this.documentElement,function(r){if(r.nodeType==a&&r.getAttribute("id")==e)return t=r,!0}),t},createElement:function(e){var t=new G;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new T,(t.attributes=new D)._ownerElement=t,t},createDocumentFragment:function(){var e=new K;return e.ownerDocument=this,e.childNodes=new T,e},createTextNode:function(e){var t=new B;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new $;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new W;return r.ownerDocument=this,r.tagName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){var t=new V;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new Y;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var r=new G,n=t.split(":"),o=r.attributes=new D;return r.childNodes=new T,r.ownerDocument=this,r.nodeName=t,r.tagName=t,r.namespaceURI=e,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,o._ownerElement=r,r},createAttributeNS:function(e,t){var r=new V,n=t.split(":");return r.ownerDocument=this,r.nodeName=t,r.name=t,r.namespaceURI=e,r.specified=!0,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=t,r}},n(R,I),G.prototype={nodeType:a,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var r=this.ownerDocument.createAttribute(e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===g?this.insertBefore(e,null):function(e,t){var r=t.parentNode;if(r){var n=e.lastChild;r.removeChild(t),n=e.lastChild}return n=e.lastChild,t.parentNode=e,t.previousSibling=n,t.nextSibling=null,n?n.nextSibling=t:e.firstChild=t,e.lastChild=t,F(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r&&r.value||""},setAttributeNS:function(e,t,r){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=""+r,this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new E(this,function(t){var r=[];return O(t,function(n){n===t||n.nodeType!=a||"*"!==e&&n.tagName!=e||r.push(n)}),r})},getElementsByTagNameNS:function(e,t){return new E(this,function(r){var n=[];return O(r,function(o){o===r||o.nodeType!==a||"*"!==e&&o.namespaceURI!==e||"*"!==t&&o.localName!=t||n.push(o)}),n})}},R.prototype.getElementsByTagName=G.prototype.getElementsByTagName,R.prototype.getElementsByTagNameNS=G.prototype.getElementsByTagNameNS,n(G,I),V.prototype.nodeType=s,n(V,I),z.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(w[b])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){r=this.data.substring(0,e)+r+this.data.substring(e+t),this.nodeValue=this.data=r,this.length=r.length}},n(z,I),B.prototype={nodeName:"#text",nodeType:u,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},n(B,z),$.prototype={nodeName:"#comment",nodeType:h},n($,z),H.prototype={nodeName:"#cdata-section",nodeType:c},n(H,z),q.prototype.nodeType=m,n(q,I),X.prototype.nodeType=y,n(X,I),J.prototype.nodeType=f,n(J,I),Y.prototype.nodeType=l,n(Y,I),K.prototype.nodeName="#document-fragment",K.prototype.nodeType=g,n(K,I),W.prototype.nodeType=p,n(W,I),Q.prototype.serializeToString=function(e,t,r){return Z.call(e,t,r)},I.prototype.toString=Z;try{if(Object.defineProperty){Object.defineProperty(E.prototype,"length",{get:function(){return C(this),this.$$length}}),Object.defineProperty(I.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case a:case g:var r=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&r.push(e(t)),t=t.nextSibling;return r.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case a:case g:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),re=function(e,t,r){e["$$"+t]=r}}}catch(e){}t.DOMImplementation=A,t.XMLSerializer=Q},function(e,t){e.exports={hexToKmlColor:function(e,t){if("string"!=typeof e)return"";if(3===(e=e.replace("#","").toLowerCase()).length)e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2];else if(6!==e.length)return"";var r=e[0]+e[1],n=e[2]+e[3],o=e[4]+e[5],i="ff";return"number"==typeof t&&t>=0&&t<=1&&((i=(255*t).toString(16)).indexOf(".")>-1&&(i=i.substr(0,i.indexOf("."))),i.length<2&&(i="0"+i)),i+o+n+r},kmlColor:function(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}}},function(e,t){t.FOLDER_KEY_NAME="_fkey"},function(e,t){function r(e,t){return"#"===e[0]&&(e=e.substr(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length,[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16),void 0===t?255:Math.round(255*t)]}function n(e){return{type:"esriSLS",style:"esriSLSSolid",color:e.stroke?r(e.stroke,e["stroke-opacity"]):null,width:e["stroke-width"]}}t.symbol=function(e){var t="GeometryCollection"===e.geometry.type?e.geometry.geometries[0].type:e.geometry.type;return"LineString"===t?n(e.properties):"Polygon"===t?function(e){return{type:"esriSFS",style:"esriSFSSolid",color:e.fill?r(e.fill,e["fill-opacity"]):null,outline:n(e)}}(e.properties):"Point"===t?(e.properties,{type:"esriSMS",style:"esriSMSCircle",color:[255,255,255,64],size:12,angle:0,xoffset:0,yoffset:0,outline:{color:[255,255,255,255],width:1,style:"esriSLSSolid",type:"esriSLS"}}):void 0}},function(e,t,r){var n=r(0),o=r(9).parse,i=r(10).parse,a=r(12).parse,s=r(13),u=r(17);function c(e,t){for(var r=[],a=n.get(e,"Placemark"),s=t&&t.style?o(e,{returnPropertiesSetter:!0}):null,u=0;u<a.length;u++)r.push(i(a[u],s));return{type:"FeatureCollection",features:r}}t.parse=function(e,t){var r=a(e);return{geoJSON:c(e,t),folders:r}},t.parseFolder=a,t.parseGeoJSON=c,t.arcgisConvertor=s,t.kmlify=u},function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var u,c=[],l=!1,f=-1;function p(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&h())}function h(){if(!l){var e=s(p);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new d(e,t)),1!==c.length||l||s(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,r){function n(e){this.options=e||{locator:{}}}function o(){this.cdata=!1}function i(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function a(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function s(e,t,r){return"string"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}function u(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}n.prototype.parseFromString=function(e,t){var r=this.options,n=new c,i=r.domBuilder||new o,s=r.errorHandler,u=r.locator,l=r.xmlns||{},f={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&i.setDocumentLocator(u),n.errorHandler=function(e,t,r){if(!e){if(t instanceof o)return t;e=t}var n={},i=e instanceof Function;function s(t){var o=e[t];!o&&i&&(o=2==e.length?function(r){e(t,r)}:e),n[t]=o&&function(e){o("[xmldom "+t+"]\t"+e+a(r))}||function(){}}return r=r||{},s("warning"),s("error"),s("fatalError"),n}(s,i,u),n.domBuilder=r.domBuilder||i,/\/x?html?$/.test(t)&&(f.nbsp=" ",f.copy="©",l[""]="http://www.w3.org/1999/xhtml"),l.xml=l.xml||"http://www.w3.org/XML/1998/namespace",e?n.parse(e,l,f):n.errorHandler.error("invalid doc source"),i.doc},o.prototype={startDocument:function(){this.doc=(new l).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,r,n){var o=this.doc,a=o.createElementNS(e,r||t),s=n.length;u(this,a),this.currentElement=a,this.locator&&i(this.locator,a);for(var c=0;c<s;c++){e=n.getURI(c);var l=n.getValue(c),f=(r=n.getQName(c),o.createAttributeNS(e,r));this.locator&&i(n.getLocator(c),f),f.value=f.nodeValue=l,a.setAttributeNode(f)}},endElement:function(e,t,r){var n=this.currentElement;n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&i(this.locator,r),u(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=s.apply(this,arguments)){if(this.cdata)var n=this.doc.createCDATASection(e);else n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&i(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,r){e=s.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&i(this.locator,n),u(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var o=n.createDocumentType(e,t,r);this.locator&&i(this.locator,o),u(this,o)}},warning:function(e){console.warn("[xmldom warning]\t"+e,a(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,a(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,a(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){o.prototype[e]=function(){return null}});var c=r(8).XMLReader,l=t.DOMImplementation=r(1).DOMImplementation;t.XMLSerializer=r(1).XMLSerializer,t.DOMParser=n},function(e,t){var r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),o=new RegExp("^"+r.source+n.source+"*(?::"+r.source+n.source+"*)?$"),i=0,a=1,s=2,u=3,c=4,l=5,f=6,p=7;function h(){}function d(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function m(e,t,r,n,o,h){for(var d,m=++t,g=i;;){var y=e.charAt(m);switch(y){case"=":if(g===a)d=e.slice(t,m),g=u;else{if(g!==s)throw new Error("attribute equal must after attrName");g=u}break;case"'":case'"':if(g===u||g===a){if(g===a&&(h.warning('attribute value must after "="'),d=e.slice(t,m)),t=m+1,!((m=e.indexOf(y,t))>0))throw new Error("attribute value no end '"+y+"' match");v=e.slice(t,m).replace(/&#?\w+;/g,o),r.add(d,v,t-1),g=l}else{if(g!=c)throw new Error('attribute value must after "="');v=e.slice(t,m).replace(/&#?\w+;/g,o),r.add(d,v,t),h.warning('attribute "'+d+'" missed start quot('+y+")!!"),t=m+1,g=l}break;case"/":switch(g){case i:r.setTagName(e.slice(t,m));case l:case f:case p:g=p,r.closed=!0;case c:case a:case s:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return h.error("unexpected end of input"),g==i&&r.setTagName(e.slice(t,m)),m;case">":switch(g){case i:r.setTagName(e.slice(t,m));case l:case f:case p:break;case c:case a:"/"===(v=e.slice(t,m)).slice(-1)&&(r.closed=!0,v=v.slice(0,-1));case s:g===s&&(v=d),g==c?(h.warning('attribute "'+v+'" missed quot(")!!'),r.add(d,v.replace(/&#?\w+;/g,o),t)):("http://www.w3.org/1999/xhtml"===n[""]&&v.match(/^(?:disabled|checked|selected)$/i)||h.warning('attribute "'+v+'" missed value!! "'+v+'" instead!!'),r.add(v,v,t));break;case u:throw new Error("attribute value missed!!")}return m;case"":y=" ";default:if(y<=" ")switch(g){case i:r.setTagName(e.slice(t,m)),g=f;break;case a:d=e.slice(t,m),g=s;break;case c:var v=e.slice(t,m).replace(/&#?\w+;/g,o);h.warning('attribute "'+v+'" missed quot(")!!'),r.add(d,v,t);case l:g=f}else switch(g){case s:r.tagName;"http://www.w3.org/1999/xhtml"===n[""]&&d.match(/^(?:disabled|checked|selected)$/i)||h.warning('attribute "'+d+'" missed value!! "'+d+'" instead2!!'),r.add(d,d,t),t=m,g=a;break;case l:h.warning('attribute space is required"'+d+'"!!');case f:g=a,t=m;break;case u:g=c,t=m;break;case p:throw new Error("elements closed character '/' and '>' must be connected to")}}m++}}function g(e,t,r){for(var n=e.tagName,o=null,i=e.length;i--;){var a=e[i],s=a.qName,u=a.value;if((p=s.indexOf(":"))>0)var c=a.prefix=s.slice(0,p),l=s.slice(p+1),f="xmlns"===c&&l;else l=s,c=null,f="xmlns"===s&&"";a.localName=l,!1!==f&&(null==o&&(o={},w(r,r={})),r[f]=o[f]=u,a.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(f,u))}for(i=e.length;i--;){(c=(a=e[i]).prefix)&&("xml"===c&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==c&&(a.uri=r[c||""]))}var p;(p=n.indexOf(":"))>0?(c=e.prefix=n.slice(0,p),l=e.localName=n.slice(p+1)):(c=null,l=e.localName=n);var h=e.uri=r[c||""];if(t.startElement(h,l,n,e),!e.closed)return e.currentNSMap=r,e.localNSMap=o,!0;if(t.endElement(h,l,n),o)for(c in o)t.endPrefixMapping(c)}function y(e,t,r,n,o){if(/^(?:script|textarea)$/i.test(r)){var i=e.indexOf("</"+r+">",t),a=e.substring(t+1,i);if(/[&<]/.test(a))return/^script$/i.test(r)?(o.characters(a,0,a.length),i):(a=a.replace(/&#?\w+;/g,n),o.characters(a,0,a.length),i)}return t+1}function v(e,t,r,n){var o=n[r];return null==o&&((o=e.lastIndexOf("</"+r+">"))<t&&(o=e.lastIndexOf("</"+r)),n[r]=o),o<t}function w(e,t){for(var r in e)t[r]=e[r]}function b(e,t,r,n){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(o=e.indexOf("--\x3e",t+4))>t?(r.comment(e,t+4,o-t-4),o+3):(n.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var o=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,o-t-9),r.endCDATA(),o+3}var i=function(e,t){var r,n=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;o.lastIndex=t,o.exec(e);for(;r=o.exec(e);)if(n.push(r),r[1])return n}(e,t),a=i.length;if(a>1&&/!doctype/i.test(i[0][0])){var s=i[1][0],u=a>3&&/^public$/i.test(i[2][0])&&i[3][0],c=a>4&&i[4][0],l=i[a-1];return r.startDTD(s,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),r.endDTD(),l.index+l[0].length}}return-1}function N(e,t,r){var n=e.indexOf("?>",t);if(n){var o=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(o){o[0].length;return r.processingInstruction(o[1],o[2]),n+2}return-1}return-1}function S(e){}function x(e,t){return e.__proto__=t,e}h.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),w(t,t={}),function(e,t,r,n,o){function i(e){var t=e.slice(1,-1);return t in r?r[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(o.error("entity not found:"+e),e)}function a(t){if(t>w){var r=e.substring(w,t).replace(/&#?\w+;/g,i);f&&s(w),n.characters(r,0,t-w),w=t}}function s(t,r){for(;t>=c&&(r=l.exec(e));)u=r.index,c=u+r[0].length,f.lineNumber++;f.columnNumber=t-u+1}var u=0,c=0,l=/.*(?:\r\n?|\n)|.*$/g,f=n.locator,p=[{currentNSMap:t}],h={},w=0;for(;;){try{var x=e.indexOf("<",w);if(x<0){if(!e.substr(w).match(/^\s*$/)){var T=n.doc,E=T.createTextNode(e.substr(w));T.appendChild(E),n.currentElement=E}return}switch(x>w&&a(x),e.charAt(x+1)){case"/":var C=e.indexOf(">",x+3),D=e.substring(x+2,C),P=p.pop();C<0?(D=e.substring(x+2).replace(/[\s<].*/,""),o.error("end tag name: "+D+" is not complete:"+P.tagName),C=x+1+D.length):D.match(/\s</)&&(D=D.replace(/[\s<].*/,""),o.error("end tag name: "+D+" maybe not complete"),C=x+1+D.length);var M=P.localNSMap,k=P.tagName==D,A=k||P.tagName&&P.tagName.toLowerCase()==D.toLowerCase();if(A){if(n.endElement(P.uri,P.localName,D),M)for(var I in M)n.endPrefixMapping(I);k||o.fatalError("end tag name: "+D+" is not match the current start tagName:"+P.tagName)}else p.push(P);C++;break;case"?":f&&s(x),C=N(e,x,n);break;case"!":f&&s(x),C=b(e,x,n,o);break;default:f&&s(x);var _=new S,O=p[p.length-1].currentNSMap,C=m(e,x,_,O,i,o),R=_.length;if(!_.closed&&v(e,C,_.tagName,h)&&(_.closed=!0,r.nbsp||o.warning("unclosed xml attribute")),f&&R){for(var L=d(f,{}),F=0;F<R;F++){var j=_[F];s(j.offset),j.locator=d(f,{})}n.locator=L,g(_,n,O)&&p.push(_),n.locator=f}else g(_,n,O)&&p.push(_);"http://www.w3.org/1999/xhtml"!==_.uri||_.closed?C++:C=y(e,C,_.tagName,i,n)}}catch(e){o.error("element parse error: "+e),C=-1}C>w?w=C:a(Math.max(x,w)+1)}}(e,t,r,n,this.errorHandler),n.endDocument()}},S.prototype={setTagName:function(e){if(!o.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,r){if(!o.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},x({},x.prototype)instanceof x||(x=function(e,t){function r(){}for(t in r.prototype=t,r=new r,e)r[t]=e[t];return r}),t.XMLReader=h},function(e,t,r){var n=r(2),o=r(0),i=o.get,a=o.get1,s=o.attr,u=o.nodeVal,c=o.xml2str,l=n.kmlColor;function f(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}t.parse=function(e,t){for(var r={},n={},o={},p=i(e,"Style"),h=i(e,"StyleMap"),d=0;d<p.length;d++){var m=f(c(p[d])).toString(16);r["#"+s(p[d],"id")]=m,n[m]=p[d]}for(var g=0;g<h.length;g++){r["#"+s(h[g],"id")]=f(c(h[g])).toString(16);for(var y=i(h[g],"Pair"),v={},w=0;w<y.length;w++)v[u(a(y[w],"key"))]=u(a(y[w],"styleUrl"));o["#"+s(h[g],"id")]=v}return t&&t.returnPropertiesSetter?function(e,t){!function(e,t,r,n,o){var i=u(a(e,"styleUrl")),s=a(e,"LineStyle"),c=a(e,"PolyStyle"),f=null;if(i){"#"!==i[0]&&(i="#"+i),t.styleUrl=i,n[i]&&(t.styleHash=n[i]),o[i]&&(t.styleMapHash=o[i],t.styleHash=n[o[i].normal]);var p=r[t.styleHash];p&&(f=a(p,"IconStyle"),s=s||a(p,"LineStyle"),c=c||a(p,"PolyStyle"))}f&&function(e,t){var r=a(t,"Icon");if(r){var n=u(a(r,"href"));n&&(e.icon=n)}}(t,f);s&&function(e,t){var r=l(u(a(t,"color"))),n=r[0],o=r[1],i=parseFloat(u(a(t,"width")));n&&(e.stroke=n);isNaN(o)||(e["stroke-opacity"]=o);isNaN(i)||(e["stroke-width"]=i)}(t,s);c&&function(e,t){var r=l(u(a(t,"color"))),n=r[0],o=r[1],i=u(a(t,"fill")),s=u(a(t,"outline"));n&&(e.fill=n);isNaN(o)||(e["fill-opacity"]=o);i&&(e["fill-opacity"]="1"===i?e["fill-opacity"]||1:0);s&&(e["stroke-opacity"]="1"===s?e["stroke-opacity"]||1:0)}(t,c)}(e,t,n,r,o)}:{styleByHash:n,styleIndex:r,styleMapIndex:o}}},function(e,t,r){var n=r(3).FOLDER_KEY_NAME,o=r(11).parse,i=r(0),a=i.get,s=i.parent,u=i.get1,c=i.nodeVal,l=i.attr;t.parse=function(e,t){var r,i={},f=o(e),p="Folder"===s(e).tagName?l(s(e),n):null,h=c(u(e,"name")),d=c(u(e,"address")),m=c(u(e,"description")),g=u(e,"TimeSpan"),y=u(e,"TimeStamp"),v=u(e,"ExtendedData"),w=u(e,"visibility");if(!f.geoms.length)return[];if(p&&(i.folder=p),h&&(i.name=h),d&&(i.address=d),m&&(i.description=m),w&&(i.visibility=c(w)),y&&(i.timestamp=c(u(y,"when"))),g){var b=c(u(g,"begin")),N=c(u(g,"end"));i.timespan={begin:b,end:N}}if(f.coordTimes.length&&(i.coordTimes=1===f.coordTimes.length?f.coordTimes[0]:f.coordTimes),v){var S=a(v,"Data"),x=a(v,"SimpleData");for(r=0;r<S.length;r++)i[S[r].getAttribute("name")]=c(u(S[r],"value"));for(r=0;r<x.length;r++)i[x[r].getAttribute("name")]=c(x[r])}t&&t(e,i);var T={type:"Feature",geometry:1===f.geoms.length?f.geoms[0]:{type:"GeometryCollection",geometries:f.geoms},properties:i};return l(e,"id")&&(T.id=l(e,"id")),T}},function(e,t,r){var n=r(0),o=n.get,i=n.get1,a=n.nodeVal,s=["Polygon","LineString","Point","Track","gx:Track"];function u(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}var c=/\s*/g;function l(e){return u(e.replace(c,"").split(","))}var f=/^\s*|\s*$/g,p=/\s+/;function h(e){for(var t=e.replace(f,"").split(p),r=[],n=0;n<t.length;n++)r.push(l(t[n]));return r}function d(e){return u(e.split(" "))}function m(e){var t=o(e,"coord","gx"),r=[],n=[];0===t.length&&(t=o(e,"gx:coord"));for(var i=0;i<t.length;i++)r.push(d(a(t[i])));for(var s=o(e,"when"),u=0;u<s.length;u++)n.push(a(s[u]));return{coords:r,times:n}}t.parse=function e(t){var r,n,u,c,f,p=[],d=[];if(i(t,"MultiGeometry"))return e(i(t,"MultiGeometry"));if(i(t,"MultiTrack"))return e(i(t,"MultiTrack"));if(i(t,"gx:MultiTrack"))return e(i(t,"gx:MultiTrack"));for(u=0;u<s.length;u++)if(n=o(t,s[u]))for(c=0;c<n.length;c++)if(r=n[c],"Point"===s[u])p.push({type:"Point",coordinates:l(a(i(r,"coordinates")))});else if("LineString"===s[u])p.push({type:"LineString",coordinates:h(a(i(r,"coordinates")))});else if("Polygon"===s[u]){var g=o(r,"LinearRing"),y=[];for(f=0;f<g.length;f++)y.push(h(a(i(g[f],"coordinates"))));p.push({type:"Polygon",coordinates:y})}else if("Track"===s[u]||"gx:Track"===s[u]){var v=m(r);p.push({type:"LineString",coordinates:v.coords}),v.times.length&&d.push(v.times)}return{geoms:p,coordTimes:d}}},function(e,t,r){var n=r(3).FOLDER_KEY_NAME,o=r(0),i=o.parent,a=o.nodeVal,s=o.get,u=o.get1,c=o.attr,l=o.setAttr;t.parse=function(e,t){var r=Array.from(s(e,"Folder"));if(0===r.length)return[];var o=t&&t.defaultFolderName?t.defaultFolderName:"unknown",f=i(r[0]),p=0,h=function(e){var t=i(e),s=u(e,"name"),f=p+++"";return l(e,n,f),{key:f,parent:"Folder"===t.tagName?c(t,n):null,name:s?a(s):o,children:r.filter(function(t){return i(t)===e}).map(h)}};return r.filter(function(e){return i(e)===f}).map(h)}},function(e,t,r){const n=r(14).graphicJSON,o=r(4).symbol;e.exports={graphicJSON:n,symbol:o}},function(e,t,r){var n=r(15).convert,o=r(4).symbol;t.graphicJSON=function(e){var t;if("GeometryCollection"===e.geometry.type){var r=n(e.geometry),i=e.geometry.geometries[0]&&e.geometry.geometries[0].type;t={spatialReference:{wkid:4326}},"Point"===i?t.points=r.map(function(e){return[e.x,e.y,e.z||0]}):"LineString"===i?(t.paths=[],r.forEach(function(e){e.paths.forEach(function(e){t.paths.push(e)})})):"Polygon"===i&&(t.rings=[],r.forEach(function(e){e.rings.forEach(function(e){t.rings.push(e)})}))}else(t=n(e.geometry)).spatialReference={wkid:4326};return{attributes:e.properties,geometry:t,symbol:o(e)}}},function(e,t,r){!function(t,n){if("object"==typeof e&&"object"==typeof e.exports&&(e.exports=n(r(16))),"object"==typeof t.navigator){if(!t.Terraformer)throw new Error("Terraformer.ArcGIS requires the core Terraformer library. https://github.com/esri/Terraformer");t.Terraformer.ArcGIS=n(t.Terraformer)}}(this,function(e){var t={};function r(e){var t,r,n,o,i=0,a=0,s=[];n=e.match(/((\+|\-)[^\+\-]+)/g),o=parseInt(n[0],32);for(var u=1;u<n.length;u+=2)i=t=parseInt(n[u],32)+i,a=r=parseInt(n[u+1],32)+a,s.push([t/o,r/o]);return s}function n(e){return function(e,t){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(e[0],e[e.length-1])||e.push(e[0]),e}function o(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function i(e){for(var t,r=0,n=0,o=e.length,i=e[n];n<o-1;n++)r+=((t=e[n+1])[0]-i[0])*(t[1]+i[1]),i=t;return r>=0}function a(e){var t=[],r=e.slice(0),o=n(r.shift().slice(0));if(o.length>=4){i(o)||o.reverse(),t.push(o);for(var a=0;a<r.length;a++){var s=n(r[a].slice(0));s.length>=4&&(i(s)&&s.reverse(),t.push(s))}}return t}function s(t,r){var n=e.Tools.arraysIntersectArrays(t,r),o=e.Tools.coordinatesContainPoint(t,r[0]);return!(n||!o)}function u(t,a){var c={};return(a=a||{}).idAttribute=a.idAttribute||void 0,!t.spatialReference||3857!==t.spatialReference.wkid&&102100!==t.spatialReference.wkid||(c.crs=e.MercatorCRS),"number"==typeof t.x&&"number"==typeof t.y&&(c.type="Point",c.coordinates=[t.x,t.y],(t.z||t.m)&&c.coordinates.push(t.z),t.m&&c.coordinates.push(t.m)),t.points&&(c.type="MultiPoint",c.coordinates=t.points.slice(0)),t.paths&&(1===t.paths.length?(c.type="LineString",c.coordinates=t.paths[0].slice(0)):(c.type="MultiLineString",c.coordinates=t.paths.slice(0))),t.rings&&(c=function(t){for(var r,o,a,u=[],c=[],l=0;l<t.length;l++){var f=n(t[l].slice(0));if(!(f.length<4))if(i(f)){var p=[f.slice().reverse()];u.push(p)}else c.push(f.slice().reverse())}for(var h=[];c.length;){a=c.pop();var d=!1;for(r=u.length-1;r>=0;r--)if(s(o=u[r][0],a)){u[r].push(a),d=!0;break}d||h.push(a)}for(;h.length;){a=h.pop();var m=!1;for(r=u.length-1;r>=0;r--)if(o=u[r][0],e.Tools.arraysIntersectArrays(o,a)){u[r].push(a),m=!0;break}m||u.push([a.reverse()])}return 1===u.length?{type:"Polygon",coordinates:u[0]}:{type:"MultiPolygon",coordinates:u}}(t.rings.slice(0))),"number"==typeof t.xmin&&"number"==typeof t.ymin&&"number"==typeof t.xmax&&"number"==typeof t.ymax&&(c.type="Polygon",c.coordinates=[[[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax]]]),(t.compressedGeometry||t.geometry||t.attributes)&&(c.type="Feature",t.compressedGeometry&&(t.geometry={paths:[r(t.compressedGeometry)]}),c.geometry=t.geometry?u(t.geometry):null,c.properties=t.attributes?o(t.attributes):null,t.attributes&&(c.id=t.attributes[a.idAttribute]||t.attributes.OBJECTID||t.attributes.FID)),new e.Primitive(c)}function c(e,t){var r,n=(t=t||{}).idAttribute||"OBJECTID";r=t.sr?{wkid:t.sr}:e&&e.crs&&"urn:ogc:def:crs:OGC:1.3:CRS84"!=e.crs.properties.name?null:{wkid:4326};var i,s={};switch(e.type){case"Point":s.x=e.coordinates[0],s.y=e.coordinates[1],e.coordinates[2]&&(s.z=e.coordinates[2]),e.coordinates[3]&&(s.m=e.coordinates[3]),s.spatialReference=r;break;case"MultiPoint":s.points=e.coordinates.slice(0),s.spatialReference=r;break;case"LineString":s.paths=[e.coordinates.slice(0)],s.spatialReference=r;break;case"MultiLineString":s.paths=e.coordinates.slice(0),s.spatialReference=r;break;case"Polygon":s.rings=a(e.coordinates.slice(0)),s.spatialReference=r;break;case"MultiPolygon":s.rings=function(e){for(var t=[],r=0;r<e.length;r++)for(var n=a(e[r]),o=n.length-1;o>=0;o--){var i=n[o].slice(0);t.push(i)}return t}(e.coordinates.slice(0)),s.spatialReference=r;break;case"Feature":e.geometry&&(s.geometry=c(e.geometry,t)),s.attributes=e.properties?o(e.properties):{},e.id&&(s.attributes[n]=e.id);break;case"FeatureCollection":for(s=[],i=0;i<e.features.length;i++)s.push(c(e.features[i],t));break;case"GeometryCollection":for(s=[],i=0;i<e.geometries.length;i++)s.push(c(e.geometries[i],t))}return s}return t.parse=u,t.convert=c,t.toGeoJSON=u,t.fromGeoJSON=c,t.parseCompressedGeometry=function(t){return new e.LineString(r(t))},t})},function(e,t){!function(t,r){"object"==typeof e&&"object"==typeof e.exports&&(e.exports=r()),"object"==typeof window&&(t.Terraformer=r())}(this,function(){var e={},t=6378137,r=57.29577951308232,n=.017453292519943,o={type:"link",properties:{href:"http://spatialreference.org/ref/sr-org/6928/ogcwkt/",type:"ogcwkt"}};function i(e){return"[object Array]"===Object.prototype.toString.call(e)}function a(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function s(e){if(e.type)switch(e.type){case"Point":return[e.coordinates[0],e.coordinates[1],e.coordinates[0],e.coordinates[1]];case"MultiPoint":case"LineString":return c(e.coordinates);case"MultiLineString":case"Polygon":return u(e.coordinates);case"MultiPolygon":return function(e){for(var t=null,r=null,n=null,o=null,i=0;i<e.length;i++)for(var a=e[i],s=0;s<a.length;s++)for(var u=a[s],c=0;c<u.length;c++){var l=u[c],f=l[0],p=l[1];null===t?t=f:f<t&&(t=f),null===r?r=f:f>r&&(r=f),null===n?n=p:p<n&&(n=p),null===o?o=p:p>o&&(o=p)}return[t,n,r,o]}(e.coordinates);case"Feature":return e.geometry?s(e.geometry):null;case"FeatureCollection":return function(e){for(var t,r=[],n=e.features.length-1;n>=0;n--)t=s(e.features[n].geometry),r.push([t[0],t[1]]),r.push([t[2],t[3]]);return c(r)}(e);case"GeometryCollection":return function(e){for(var t,r=[],n=e.geometries.length-1;n>=0;n--)t=s(e.geometries[n]),r.push([t[0],t[1]]),r.push([t[2],t[3]]);return c(r)}(e);default:throw new Error("Unknown type: "+e.type)}return null}function u(e){for(var t=null,r=null,n=null,o=null,i=0;i<e.length;i++)for(var a=e[i],s=0;s<a.length;s++){var u=a[s],c=u[0],l=u[1];null===t?t=c:c<t&&(t=c),null===r?r=c:c>r&&(r=c),null===n?n=l:l<n&&(n=l),null===o?o=l:l>o&&(o=l)}return[t,n,r,o]}function c(e){for(var t=null,r=null,n=null,o=null,i=0;i<e.length;i++){var a=e[i],s=a[0],u=a[1];null===t?t=s:s<t&&(t=s),null===r?r=s:s>r&&(r=s),null===n?n=u:u<n&&(n=u),null===o?o=u:u>o&&(o=u)}return[t,n,r,o]}function l(e){var t=s(e);return{x:t[0],y:t[1],w:Math.abs(t[0]-t[2]),h:Math.abs(t[1]-t[3])}}function f(e){return e*r}function p(e){return e*n}function h(e){var r=e[0],n=e[1];return[f(r/t)-360*Math.floor((f(r/t)+180)/360),f(Math.PI/2-2*Math.atan(Math.exp(-1*n/t)))]}function d(e){var r=e[0],n=Math.max(Math.min(e[1],89.99999),-89.99999);return[p(r)*t,t/2*Math.log((1+Math.sin(p(n)))/(1-Math.sin(p(n))))]}function m(e,t,r){if("Point"===e.type)e.coordinates=t(e.coordinates);else if("Feature"===e.type)e.geometry=m(e.geometry,t,!0);else if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)e.features[n]=m(e.features[n],t,!0);else if("GeometryCollection"===e.type)for(var i=0;i<e.geometries.length;i++)e.geometries[i]=m(e.geometries[i],t,!0);else e.coordinates=function e(t,r){for(var n=0;n<t.length;n++)"number"==typeof t[n][0]&&(t[n]=r(t[n])),"object"==typeof t[n]&&(t[n]=e(t[n],r));return t}(e.coordinates,t);return r||t===d&&(e.crs=o),t===h&&delete e.crs,e}function g(e){return m(e,d)}function y(e){return m(e,h)}function v(e,t){return e[0]>t[0]?-1:e[0]<t[0]?1:e[1]>t[1]?-1:e[1]<t[1]?1:0}function w(e,t,r){return function(e,t){return e<t?-1:e>t?1:0}((t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1]),0)}function b(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function N(e,t){var r=t;for(var n in e){var o=w(t,r,e[n]);(-1===o||0===o&&b(t,e[n])>b(t,r))&&(r=e[n])}return r}function S(e){if(0===e.length)return[];if(1===e.length)return e;for(var t=[e.sort(v)[0]],r=0;r<t.length;r++){var n=N(e,t[r]);n!==t[0]&&t.push(n)}return t}function x(e,t){for(var r=!1,n=-1,o=e.length,i=o-1;++n<o;i=n)(e[n][1]<=t[1]&&t[1]<e[i][1]||e[i][1]<=t[1]&&t[1]<e[n][1])&&t[0]<(e[i][0]-e[n][0])*(t[1]-e[n][1])/(e[i][1]-e[n][1])+e[n][0]&&(r=!r);return r}function T(e,t){if(e&&e.length){if(1===e.length)return x(e[0],t);if(x(e[0],t)){for(var r=1;r<e.length;r++)if(x(e[r],t))return!1;return!0}return!1}return!1}function E(e,t,r,n){var o=(n[0]-r[0])*(e[1]-r[1])-(n[1]-r[1])*(e[0]-r[0]),i=(t[0]-e[0])*(e[1]-r[1])-(t[1]-e[1])*(e[0]-r[0]),a=(n[1]-r[1])*(t[0]-e[0])-(n[0]-r[0])*(t[1]-e[1]);if(0!==a){var s=o/a,u=i/a;if(0<=s&&s<=1&&0<=u&&u<=1)return!0}return!1}function C(e){return!isNaN(parseFloat(e))&&isFinite(e)}function D(e,t){if(C(e[0][0])){if(C(t[0][0])){for(var r=0;r<e.length-1;r++)for(var n=0;n<t.length-1;n++)if(E(e[r],e[r+1],t[n],t[n+1]))return!0}else for(var o=0;o<t.length;o++)if(D(e,t[o]))return!0}else for(var i=0;i<e.length;i++)if(D(e[i],t))return!0;return!1}function P(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].slice();!1===M(n[0],n[n.length-1])&&n.push(n[0]),t.push(n)}return t}function M(e,t){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function k(e,t){if(e.length!==t.length)return!1;for(var r=e.slice().sort(v),n=t.slice().sort(v),o=0;o<r.length;o++){if(r[o].length!==n[o].length)return!1;for(var i=0;i<r.length;i++)if(r[o][i]!==n[o][i])return!1}return!0}var A=["length"];function I(e){if(e)switch(e.type){case"Point":return new _(e);case"MultiPoint":return new O(e);case"LineString":return new R(e);case"MultiLineString":return new L(e);case"Polygon":return new F(e);case"MultiPolygon":return new U(e);case"Feature":return new G(e);case"FeatureCollection":return new V(e);case"GeometryCollection":return new z(e);default:throw new Error("Unknown type: "+e.type)}}function _(e){var t=Array.prototype.slice.call(arguments);if(e&&"Point"===e.type&&e.coordinates)a(this,e);else if(e&&i(e))this.coordinates=e;else{if(!(t.length>=2))throw"Terraformer: invalid input for Terraformer.Point";this.coordinates=t}this.type="Point"}function O(e){if(e&&"MultiPoint"===e.type&&e.coordinates)a(this,e);else{if(!i(e))throw"Terraformer: invalid input for Terraformer.MultiPoint";this.coordinates=e}this.type="MultiPoint"}function R(e){if(e&&"LineString"===e.type&&e.coordinates)a(this,e);else{if(!i(e))throw"Terraformer: invalid input for Terraformer.LineString";this.coordinates=e}this.type="LineString"}function L(e){if(e&&"MultiLineString"===e.type&&e.coordinates)a(this,e);else{if(!i(e))throw"Terraformer: invalid input for Terraformer.MultiLineString";this.coordinates=e}this.type="MultiLineString"}function F(e){if(e&&"Polygon"===e.type&&e.coordinates)a(this,e);else{if(!i(e))throw"Terraformer: invalid input for Terraformer.Polygon";this.coordinates=e}this.type="Polygon"}function U(e){if(e&&"MultiPolygon"===e.type&&e.coordinates)a(this,e);else{if(!i(e))throw"Terraformer: invalid input for Terraformer.MultiPolygon";this.coordinates=e}this.type="MultiPolygon"}function G(e){if(e&&"Feature"===e.type)a(this,e);else{if(!(e&&e.type&&e.coordinates))throw"Terraformer: invalid input for Terraformer.Feature";this.geometry=e}this.type="Feature"}function V(e){if(e&&"FeatureCollection"===e.type&&e.features)a(this,e);else{if(!i(e))throw"Terraformer: invalid input for Terraformer.FeatureCollection";this.features=e}this.type="FeatureCollection"}function z(e){if(e&&"GeometryCollection"===e.type&&e.geometries)a(this,e);else if(i(e))this.geometries=e;else{if(!e.coordinates||!e.type)throw"Terraformer: invalid input for Terraformer.GeometryCollection";this.type="GeometryCollection",this.geometries=[e]}this.type="GeometryCollection"}function B(e,t,r){for(var n=d(e),o=r||64,i={type:"Polygon",coordinates:[[]]},a=1;a<=o;a++){var s=a*(360/o)*Math.PI/180;i.coordinates[0].push([n[0]+t*Math.cos(s),n[1]+t*Math.sin(s)])}return i.coordinates=P(i.coordinates),y(i)}function $(e,t,r){var n=r||64,o=t||250;if(!e||e.length<2||!o||!n)throw new Error("Terraformer: missing parameter for Terraformer.Circle");a(this,new G({type:"Feature",geometry:B(e,o,n),properties:{radius:o,center:e,steps:n}}))}return I.prototype.toMercator=function(){return g(this)},I.prototype.toGeographic=function(){return y(this)},I.prototype.envelope=function(){return l(this)},I.prototype.bbox=function(){return s(this)},I.prototype.convexHull=function(){var e,t,r=[];if("Point"===this.type)return null;if("LineString"===this.type||"MultiPoint"===this.type){if(!(this.coordinates&&this.coordinates.length>=3))return null;r=this.coordinates}else if("Polygon"===this.type||"MultiLineString"===this.type){if(!(this.coordinates&&this.coordinates.length>0))return null;for(e=0;e<this.coordinates.length;e++)r=r.concat(this.coordinates[e]);if(r.length<3)return null}else if("MultiPolygon"===this.type){if(!(this.coordinates&&this.coordinates.length>0))return null;for(e=0;e<this.coordinates.length;e++)for(t=0;t<this.coordinates[e].length;t++)r=r.concat(this.coordinates[e][t]);if(r.length<3)return null}else if("Feature"===this.type){return new I(this.geometry).convexHull()}return new F({type:"Polygon",coordinates:P([S(r)])})},I.prototype.toJSON=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&-1===A.indexOf(t)&&(e[t]=this[t]);return e.bbox=s(this),e},I.prototype.contains=function(e){return new I(e).within(this)},I.prototype.within=function(e){var t,r;if("Feature"===e.type&&(e=e.geometry),"Point"===e.type&&"Point"===this.type)return M(this.coordinates,e.coordinates);if("MultiLineString"===e.type&&"Point"===this.type)for(t=0;t<e.coordinates.length;t++){var n={type:"LineString",coordinates:e.coordinates[t]};if(this.within(n))return!0}if(("LineString"===e.type||"MultiPoint"===e.type)&&"Point"===this.type)for(t=0;t<e.coordinates.length;t++){if(this.coordinates.length!==e.coordinates[t].length)return!1;if(M(this.coordinates,e.coordinates[t]))return!0}if("Polygon"===e.type){if("Polygon"===this.type){if(e.coordinates.length===this.coordinates.length)for(t=0;t<this.coordinates.length;t++)if(k(this.coordinates[t],e.coordinates[t]))return!0;return!(!this.coordinates.length||!T(e.coordinates,this.coordinates[0][0]))&&!D(P(this.coordinates),P(e.coordinates))}if("Point"===this.type)return T(e.coordinates,this.coordinates);if("LineString"===this.type||"MultiPoint"===this.type){if(!this.coordinates||0===this.coordinates.length)return!1;for(t=0;t<this.coordinates.length;t++)if(!1===T(e.coordinates,this.coordinates[t]))return!1;return!0}if("MultiLineString"===this.type){for(t=0;t<this.coordinates.length;t++){if(!1===new R(this.coordinates[t]).within(e))return r++,!1}return!0}if("MultiPolygon"===this.type){for(t=0;t<this.coordinates.length;t++){if(!1===new I({type:"Polygon",coordinates:this.coordinates[t]}).within(e))return!1}return!0}}if("MultiPolygon"===e.type){if("Point"===this.type){if(e.coordinates.length)for(t=0;t<e.coordinates.length;t++)if(T(e.coordinates[t],this.coordinates)&&!1===D([this.coordinates],e.coordinates))return!0;return!1}if("Polygon"===this.type){for(t=0;t<this.coordinates.length;t++)if(e.coordinates[t].length===this.coordinates.length)for(j=0;j<this.coordinates.length;j++)if(k(this.coordinates[j],e.coordinates[t][j]))return!0;if(!1===D(this.coordinates,e.coordinates)&&e.coordinates.length){for(t=0;t<e.coordinates.length;t++)r=!1!==T(e.coordinates[t],this.coordinates[0][0]);return r}}else if("LineString"===this.type||"MultiPoint"===this.type)for(t=0;t<e.coordinates.length;t++){var o={type:"Polygon",coordinates:e.coordinates[t]};return!!this.within(o)}else{if("MultiLineString"===this.type){for(t=0;t<this.coordinates.length;t++){if(!1===new R(this.coordinates[t]).within(e))return!1}return!0}if("MultiPolygon"===this.type){for(t=0;t<e.coordinates.length;t++){var i={type:"Polygon",coordinates:e.coordinates[t]};if(!1===this.within(i))return!1}return!0}}}return!1},I.prototype.intersects=function(e){"Feature"===e.type&&(e=e.geometry);var t=new I(e);return!(!this.within(e)&&!t.within(this))||("Point"!==this.type&&"MultiPoint"!==this.type&&"Point"!==e.type&&"MultiPoint"!==e.type?D(this.coordinates,e.coordinates):"Feature"===this.type?new I(this.geometry).intersects(e):(function(){var e=Array.prototype.slice.apply(arguments);void 0!==typeof console&&console.warn&&console.warn.apply(console,e)}("Type "+this.type+" to "+e.type+" intersection is not supported by intersects"),!1))},_.prototype=new I,_.prototype.constructor=_,O.prototype=new I,O.prototype.constructor=O,O.prototype.forEach=function(e){for(var t=0;t<this.coordinates.length;t++)e.apply(this,[this.coordinates[t],t,this.coordinates]);return this},O.prototype.addPoint=function(e){return this.coordinates.push(e),this},O.prototype.insertPoint=function(e,t){return this.coordinates.splice(t,0,e),this},O.prototype.removePoint=function(e){return"number"==typeof e?this.coordinates.splice(e,1):this.coordinates.splice(this.coordinates.indexOf(e),1),this},O.prototype.get=function(e){return new _(this.coordinates[e])},R.prototype=new I,R.prototype.constructor=R,R.prototype.addVertex=function(e){return this.coordinates.push(e),this},R.prototype.insertVertex=function(e,t){return this.coordinates.splice(t,0,e),this},R.prototype.removeVertex=function(e){return this.coordinates.splice(e,1),this},L.prototype=new I,L.prototype.constructor=L,L.prototype.forEach=function(e){for(var t=0;t<this.coordinates.length;t++)e.apply(this,[this.coordinates[t],t,this.coordinates])},L.prototype.get=function(e){return new R(this.coordinates[e])},F.prototype=new I,F.prototype.constructor=F,F.prototype.addVertex=function(e){return this.insertVertex(e,this.coordinates[0].length-1),this},F.prototype.insertVertex=function(e,t){return this.coordinates[0].splice(t,0,e),this},F.prototype.removeVertex=function(e){return this.coordinates[0].splice(e,1),this},F.prototype.close=function(){this.coordinates=P(this.coordinates)},F.prototype.hasHoles=function(){return this.coordinates.length>1},F.prototype.holes=function(){if(holes=[],this.hasHoles())for(var e=1;e<this.coordinates.length;e++)holes.push(new F([this.coordinates[e]]));return holes},U.prototype=new I,U.prototype.constructor=U,U.prototype.forEach=function(e){for(var t=0;t<this.coordinates.length;t++)e.apply(this,[this.coordinates[t],t,this.coordinates])},U.prototype.get=function(e){return new F(this.coordinates[e])},U.prototype.close=function(){var e=[];return this.forEach(function(t){e.push(P(t))}),this.coordinates=e,this},G.prototype=new I,G.prototype.constructor=G,V.prototype=new I,V.prototype.constructor=V,V.prototype.forEach=function(e){for(var t=0;t<this.features.length;t++)e.apply(this,[this.features[t],t,this.features])},V.prototype.get=function(e){var t;return this.forEach(function(r){r.id===e&&(t=r)}),new G(t)},z.prototype=new I,z.prototype.constructor=z,z.prototype.forEach=function(e){for(var t=0;t<this.geometries.length;t++)e.apply(this,[this.geometries[t],t,this.geometries])},z.prototype.get=function(e){return new I(this.geometries[e])},$.prototype=new I,$.prototype.constructor=$,$.prototype.recalculate=function(){return this.geometry=B(this.properties.center,this.properties.radius,this.properties.steps),this},$.prototype.center=function(e){return e&&(this.properties.center=e,this.recalculate()),this.properties.center},$.prototype.radius=function(e){return e&&(this.properties.radius=e,this.recalculate()),this.properties.radius},$.prototype.steps=function(e){return e&&(this.properties.steps=e,this.recalculate()),this.properties.steps},$.prototype.toJSON=function(){return I.prototype.toJSON.call(this)},e.Primitive=I,e.Point=_,e.MultiPoint=O,e.LineString=R,e.MultiLineString=L,e.Polygon=F,e.MultiPolygon=U,e.Feature=G,e.FeatureCollection=V,e.GeometryCollection=z,e.Circle=$,e.toMercator=g,e.toGeographic=y,e.Tools={},e.Tools.positionToMercator=d,e.Tools.positionToGeographic=h,e.Tools.applyConverter=m,e.Tools.toMercator=g,e.Tools.toGeographic=y,e.Tools.createCircle=B,e.Tools.calculateBounds=s,e.Tools.calculateEnvelope=l,e.Tools.coordinatesContainPoint=x,e.Tools.polygonContainsPoint=T,e.Tools.arraysIntersectArrays=D,e.Tools.coordinatesContainPoint=x,e.Tools.coordinatesEqual=k,e.Tools.convexHull=S,e.Tools.isConvex=function(e){for(var t,r=0;r<e.length-3;r++){var n=e[r],o=e[r+1],i=e[r+2],a=[o[0]-n[0],o[1]-n[1]],s=i[0]*a[1]-i[1]*a[0]+a[0]*n[1]-a[1]*n[0];if(0===r)t=s<0;else if(t&&s>0||!t&&s<0)return!1}return!0},e.MercatorCRS=o,e.GeographicCRS={type:"link",properties:{href:"http://spatialreference.org/ref/epsg/4326/ogcwkt/",type:"ogcwkt"}},e})},function(e,t,r){var n=r(18),o=r(2),i=r(20),a=r(21),s=n.tag,u=n.encode;function c(e,t,r,n){return function e(o){return 0===(o=o||[]).length?"":o.map(function(o){var i=t.filter(function(e){return e.properties[n.folder]===o.key});return s("Folder",s("name",o.name)+e(o.children)+i.map(l(n,r)).join(""))}).join("")}(e)}function l(e,t){return function(r){if(!r.properties||!i.valid(r.geometry))return"";var n=i.any(r.geometry);if(!n)return"";var c="",l="";if(e.simpleStyle){var p=a.hashStyle(r.properties);p&&(i.isPoint(r.geometry)&&a.hasMarkerStyle(r.properties)?(-1===t.indexOf(p)&&(c=function(e,t){return s("Style",s("IconStyle",s("Icon",s("href",a.iconUrl(e))))+s("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]]),[["id",t]])}(r.properties,p),t.push(p)),l=s("styleUrl","#"+p)):(i.isPolygon(r.geometry)||i.isLine(r.geometry))&&a.hasPolygonAndLineStyle(r.properties)&&(-1===t.indexOf(p)&&(c=function(e,t){var r=s("LineStyle",[s("color",o.hexToKmlColor(e.stroke,e["stroke-opacity"])||"ff555555")+s("width",void 0===e["stroke-width"]?2:e["stroke-width"])]),n="";(e.fill||e["fill-opacity"])&&(n=s("PolyStyle",[s("color",o.hexToKmlColor(e.fill,e["fill-opacity"])||"88555555")]));return s("Style",r+n,[["id",t]])}(r.properties,p),t.push(p)),l=s("styleUrl","#"+p)))}return c+s("Placemark",function(e,t){return e[t.name]?s("name",u(e[t.name])):""}(r.properties,e)+function(e,t){return e[t.description]?s("description",u(e[t.description])):""}(r.properties,e)+function(e){return s("ExtendedData",function(e){var t=[];for(var r in e)t.push([r,e[r]]);return t}(e).map(f).join(""))}(r.properties)+function(e,t){return e[t.timestamp]?s("TimeStamp",s("when",u(e[t.timestamp]))):""}(r.properties,e)+n+l)}}function f(e){return s("Data",s("value",u(e[1])),[["name",u(e[0])]])}e.exports=function(e,t,r){return r=r||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simpleStyle:!1,timestamp:"timestamp",folder:"folder"},t=t||[],'<?xml version="1.0" encoding="UTF-8"?>'+s("kml",s("Document",function(e){return void 0!==e.documentName?s("name",e.documentName):""}(r)+function(e){return void 0!==e.documentDescription?s("description",e.documentDescription):""}(r)+function(e,t,r){if(!e.type)return"";var n=[];switch(e.type){case"FeatureCollection":return e.features?t.length>0&&r[c]?c(t,e.features,n,r):e.features.map(l(r,n)).join(""):"";case"Feature":return l(r,n)(e);default:return l(r,n)({type:"Feature",geometry:e,properties:{}})}}(e,t,r)),[["xmlns","http://www.opengis.net/kml/2.2"]])}},function(e,t,r){var n=r(19);function o(e){return Object.keys(e).length?" "+Object.keys(e).map(function(t){return t+'="'+n(e[t])+'"'}).join(" "):""}e.exports.attr=o,e.exports.tagClose=function(e,t){return"<"+e+o(t)+"/>"},e.exports.tag=function(e,t,r){(Array.isArray(t)||"string"==typeof t)&&(r=t,t={});Array.isArray(r)&&(r="\n"+r.map(function(e){return"  "+e}).join("\n")+"\n");return"<"+e+o(t)+">"+r+"</"+e+">"}},function(e,t){(e.exports=function e(t,r){var n;if(null!==t&&void 0!==t)return r=(r||"").replace(/[^&"<>\']/g,""),n="([&\"<>'])".replace(new RegExp("["+r+"]","g"),""),t.replace(new RegExp(n,"g"),function(t,r){return e.map[r]})}).map={">":"&gt;","<":"&lt;","'":"&apos;",'"':"&quot;","&":"&amp;"}},function(e,t){e.exports={isPoint:function(e){return"Point"===e.type||"MultiPoint"===e.type},isPolygon:function(e){return"Polygon"===e.type||"MultiPolygon"===e.type},isLine:function(e){return"LineString"===e.type||"MultiLineString"===e.type},valid:function(e){return e&&e.type&&(e.coordinates||"GeometryCollection"===e.type&&e.geometries&&e.geometries.every(geometry.valid))},any:function(e){return geometry[e.type]?geometry[e.type](e):""}}},function(e,t){e.exports={hasPolygonAndLineStyle:function(e){var t={stroke:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,"fill-opacity":!0};for(var r in e)if(t[r])return!0},hashStyle:function(e){var t="";return e["marker-symbol"]&&(t=t+"ms"+e["marker-symbol"]),e["marker-color"]&&(t=t+"mc"+e["marker-color"].replace("#","")),e["marker-size"]&&(t=t+"ms"+e["marker-size"]),e.stroke&&(t=t+"s"+e.stroke.replace("#","")),e["stroke-width"]&&(t=t+"sw"+e["stroke-width"].toString().replace(".","")),e["stroke-opacity"]&&(t=t+"mo"+e["stroke-opacity"].toString().replace(".","")),e.fill&&(t=t+"f"+e.fill.replace("#","")),e["fill-opacity"]&&(t=t+"fo"+e["fill-opacity"].toString().replace(".","")),t},hasMarkerStyle:function(e){return!!(e["marker-size"]||e["marker-symbol"]||e["marker-color"])},iconUrl:function(e){var t=e["marker-size"]||"medium",r=e["marker-symbol"]?"-"+e["marker-symbol"]:"",n=(e["marker-color"]||"7e7e7e").replace("#","");return"https://api.tiles.mapbox.com/v3/marker/pin-"+t.charAt(0)+r+"+"+n+".png"}}}]);